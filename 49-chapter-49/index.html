
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../48-chapter-48/">
      
      
        <link rel="next" href="../50-chapter-50/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Chapter 7.6: Spawning & Despawning - Hydration/Dehydration (Brain & Body) - Mastering Sigilborne: Building a Generational Ninja Life Simulator</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="sky" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-76-spawning-despawning-hydrationdehydration-brain-body" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Mastering Sigilborne: Building a Generational Ninja Life Simulator" class="md-header__button md-logo" aria-label="Mastering Sigilborne: Building a Generational Ninja Life Simulator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mastering Sigilborne: Building a Generational Ninja Life Simulator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 7.6: Spawning & Despawning - Hydration/Dehydration (Brain & Body)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Mastering Sigilborne: Building a Generational Ninja Life Simulator" class="md-nav__button md-logo" aria-label="Mastering Sigilborne: Building a Generational Ninja Life Simulator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Mastering Sigilborne: Building a Generational Ninja Life Simulator
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-chapter-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.1: Project Setup for Godot 4.5 with C#
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-chapter-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.2: The Brain (C#) - Headless Simulation Layer
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-chapter-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.3: The Body (GDScript) - Reactive Presentation Layer
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-chapter-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.4: Directory Structure - Enforcing Separation of Concerns
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-chapter-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.5: Entity Model - Lightweight ECS-lite in C#
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-chapter-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.6: Component Architecture - Composition over Inheritance
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-chapter-7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.7: Job System & Concurrency - Multithreaded Processing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-chapter-8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.8: Thread Safety - Command Buffers & Double Buffering
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-chapter-9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.9: Scene Composition - Standardizing Godot Scenes
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-chapter-10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.10: Naming Conventions & Scene Interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-chapter-11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.11: Animation Event Protocol - Syncing Brain & Body
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-chapter-12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.12: Interop Layer - C# to GDScript Communication
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-chapter-13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.13: Global State Management - Data Ownership
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../14-chapter-14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.14: Debugging Tools - Console & State Inspector
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-chapter-15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1.15: Main Loop Execution Order - Tick vs. Frame
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../16-chapter-16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2.1: Input Manager - Capturing Raw Input (GDScript)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../17-chapter-17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2.2: Standard Movement Logic - Velocity & Friction (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../18-chapter-18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2.3: Shift-Sliding Mechanic - Direction Lock (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../19-chapter-19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2.4: Physics Layer - Hybrid Movement Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../20-chapter-20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3.1: Glyph Database - Concepts vs. Symbols (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../21-chapter-21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3.2: Glyph Discovery System - Player Knowledge State (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../22-chapter-22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3.3: Glyph Experimentation - Trial & Error Casting (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../23-chapter-23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3.4: Subtypes & Modifiers - Procedural Nuance for Glyphs (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../24-chapter-24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3.5: Glyph Acquisition - Teachers & Scrolls (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../25-chapter-25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4.1: Input Buffer - Storing Glyph Sequences (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../26-chapter-26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4.2: Combo Resolver - Trie Structure for Spell Detection (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../27-chapter-27/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4.3: Spell Data Architecture - Data-Driven Definitions (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../28-chapter-28/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4.4: Casting State Machine - Player Casting Flow (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../29-chapter-29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4.5: Visual Feedback - Particles & Animations (GDScript)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../30-chapter-30/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.1: Biological Simulation - The Bio-Tick (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../31-chapter-31/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.2: Core Stats (Struct)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../32-chapter-32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.3: Metabolism System - Dynamic Decay Rates (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../33-chapter-33/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.4: Weather & Environment - Global Environmental State (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../34-chapter-34/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.5: Damage & Recovery Pipeline - Wounds & Status Effects (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../35-chapter-35/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.6: Status Effect Data - Definition vs. Instance (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../36-chapter-36/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.7: Recovery Logic - Health, Stamina, Chakra Regeneration (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../37-chapter-37/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5.8: Weather & Environment - Global Environmental State (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../38-chapter-38/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6.1: Physics Layer - Hitbox & Hurtbox Detection (GDScript)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../39-chapter-39/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6.2: The Math Layer - Damage Calculator (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../40-chapter-40/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6.3: Equipment & Inventory - Inventory Data Structure (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../41-chapter-41/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6.4: Equipment Logic - Recalculating Stats (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../42-chapter-42/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6.5: World Boss Mechanics - Multi-Part Entities (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../43-chapter-43/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6.6: Titan AI State - Specialized State Machine (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../44-chapter-44/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.1: Perception System - Spatial Hashing (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../45-chapter-45/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.2: The Senses - Vision, Hearing & Chakra Sense (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../46-chapter-46/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.3: Stealth Mechanics - Visibility & Detection Meter (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../47-chapter-47/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.4: Decision Making: Utility AI (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../48-chapter-48/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.5: Ecology Simulation - Virtual Agents (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.6: Spawning & Despawning - Hydration/Dehydration (Brain & Body)
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7.6: Spawning & Despawning - Hydration/Dehydration (Brain & Body)
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-76-spawning-despawning-hydrationdehydration-brain-body" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 7.6: Spawning &amp; Despawning - Hydration/Dehydration (Brain &amp; Body)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chapter 7.6: Spawning &amp; Despawning - Hydration/Dehydration (Brain &amp; Body)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-the-seamless-world-hydration-dehydration" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. The Seamless World: Hydration &amp; Dehydration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-refining-ecologymanagercs-for-dehydration" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Refining EcologyManager.cs for Dehydration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Refining EcologyManager.cs for Dehydration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-update-aisystemcs-for-simplified-ai-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1. Update AISystem.cs for Simplified AI State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-update-gamemanager-to-pass-aisystem-to-ecologymanager" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. Update GameManager to Pass AISystem to EcologyManager
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-refining-worldsimulationcs-for-chunk-coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Refining WorldSimulation.cs for Chunk Coordinates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-testing-hydrationdehydration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Testing Hydration/Dehydration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../50-chapter-50/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8.1: Faction System - The Relationship Graph (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../51-chapter-51/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8.2: The Simulation Clock - Game Time & Load Balancing (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../52-chapter-52/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8.3: Market Simulation - Supply & Demand (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../53-chapter-53/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8.4: Trade Routes - Caravans as Arteries (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../54-chapter-54/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8.5: Crime & Justice - The Heat System (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../55-chapter-55/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8.6: Bounty & Punishment - Escalation & Consequences (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../56-chapter-56/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9.1: Ritual System - Pattern Matching & Execution (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../57-chapter-57/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9.2: Seals & Locks - Logical Locks (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../58-chapter-58/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9.3: Ritual System - Simple, Advanced & Forbidden (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../59-chapter-59/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9.4: Forbidden Contracts & Spirit Contracts (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../60-chapter-60/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9.5: Corruption Pacts & Multi-Life Persistence of Rituals (C#)
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-76-spawning-despawning-hydrationdehydration-brain-body" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 7.6: Spawning &amp; Despawning - Hydration/Dehydration (Brain &amp; Body)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chapter 7.6: Spawning &amp; Despawning - Hydration/Dehydration (Brain &amp; Body)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-the-seamless-world-hydration-dehydration" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. The Seamless World: Hydration &amp; Dehydration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-refining-ecologymanagercs-for-dehydration" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Refining EcologyManager.cs for Dehydration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Refining EcologyManager.cs for Dehydration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-update-aisystemcs-for-simplified-ai-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1. Update AISystem.cs for Simplified AI State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-update-gamemanager-to-pass-aisystem-to-ecologymanager" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. Update GameManager to Pass AISystem to EcologyManager
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-refining-worldsimulationcs-for-chunk-coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Refining WorldSimulation.cs for Chunk Coordinates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-testing-hydrationdehydration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Testing Hydration/Dehydration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Chapter 7.6: Spawning & Despawning - Hydration/Dehydration (Brain & Body)</h1>

<h2 id="chapter-76-spawning-despawning-hydrationdehydration-brain-body">Chapter 7.6: Spawning &amp; Despawning - Hydration/Dehydration (Brain &amp; Body)</h2>
<p>Building on our <code>EcologyManager</code>'s concept of <code>VirtualAgent</code>s, this chapter focuses on the seamless transition of entities between "Virtual Agent" (data-only in C# Brain) and "Active Entity" (fully simulated with Godot Nodes in GDScript Body) states. We'll refine the hydration (spawning) and dehydration (despawning) process, ensuring entities appear and disappear gracefully as the player enters and leaves chunks, as specified in TDD 05.4.2 and TDD 05.4.3.</p>
<h3 id="1-the-seamless-world-hydration-dehydration">1. The Seamless World: Hydration &amp; Dehydration</h3>
<p>The illusion of a persistent world relies on entities appearing and disappearing smoothly.</p>
<ul>
<li><strong>Dehydration</strong>: When an active entity (NPC, animal) moves out of the player's loaded chunk radius, its visual Godot Node is removed, and its <code>CoreStats</code> and <code>TransformComponent</code> data are converted into a <code>VirtualAgent</code> in <code>EcologyManager</code>.</li>
<li><strong>Hydration</strong>: When the player moves into a chunk containing a <code>VirtualAgent</code>, that <code>VirtualAgent</code>'s data is used to <code>CreateEntity()</code> in <code>EntityManager</code>, and a corresponding visual Godot Node is spawned by <code>EntityViewManager.gd</code>.</li>
</ul>
<p>This process is critical for performance and maintaining consistency between the Brain and Body.</p>
<h3 id="2-refining-ecologymanagercs-for-dehydration">2. Refining <code>EcologyManager.cs</code> for Dehydration</h3>
<p>The <code>HydrateAndDehydrateChunks()</code> method currently handles both. Let's make sure the dehydration part is robust.</p>
<p>Open <code>res://_Brain/Systems/Ecology/EcologyManager.cs</code>:</p>
<pre><code class="language-csharp">// _Brain/Systems/Ecology/EcologyManager.cs
using Godot;
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using Sigilborne.Core;
using Sigilborne.Entities;
using Sigilborne.Entities.Components;
using Sigilborne.Systems.Biology;
using Sigilborne.Systems.AI;
using Sigilborne.Systems.Movement;
using Sigilborne.Systems.Weather;
using Sigilborne.Utils;
using System.Linq;

namespace Sigilborne.Systems.Ecology
{
    public class EcologyManager
    {
        // ... (existing fields) ...

        // Player's current loaded chunk (used for hydration/dehydration radius)
        private Vector2I _playerLoadedChunk = Vector2I.Zero;
        private const int LOAD_RADIUS_CHUNKS = 2; // TDD 08.2.1: Player loads chunks within a radius (e.g., 2 chunks)

        public EcologyManager(EntityManager entityManager, EventBus eventBus, BiologicalSystem biologicalSystem, TransformSystem transformSystem, AISystem aiSystem, MovementSystem movementSystem, WeatherSystem weatherSystem, JobSystem jobSystem, SpatialHashGrid spatialGrid)
        {
            _entityManager = entityManager;
            _eventBus = eventBus;
            _biologicalSystem = biologicalSystem;
            _transformSystem = transformSystem;
            _aiSystem = aiSystem;
            _movementSystem = movementSystem;
            _weatherSystem = weatherSystem;
            _jobSystem = jobSystem;
            _spatialGrid = spatialGrid;

            // Subscribe to entity lifecycle events
            // We'll manage OnEntitySpawned/Despawned internally for hydration/dehydration
            // This manager *is* the source of truth for spawning/despawning game entities.
            _eventBus.OnPlayerCoreStatsChanged += OnPlayerCoreStatsChanged;

            GD.Print(&quot;EcologyManager: Initialized.&quot;);
        }

        // ... (OnPlayerCoreStatsChanged, Tick, ProcessVirtualAgentTick methods) ...

        /// &lt;summary&gt;
        /// Manages the transition of entities between Active (full simulation) and Virtual (lightweight) states.
        /// (TDD 05.4.3: Transition (Hydration/Dehydration))
        /// &lt;/summary&gt;
        private void HydrateAndDehydrateChunks()
        {
            // --- Dehydration: Convert active entities in unloaded chunks to virtual agents ---
            // Iterate all active entities (excluding player)
            List&lt;EntityID&gt; activeEntitiesToDehydrate = new List&lt;EntityID&gt;();
            EntityID playerID = _entityManager.GetPlayerEntityID();

            foreach (EntityID activeID in _entityManager.GetAllActiveEntityIDs())
            {
                if (activeID == playerID) continue; // Never dehydrate player

                if (_transformSystem.TryGetTransform(activeID, out TransformComponent transform))
                {
                    Vector2I entityChunk = GameManager.Instance.World.GetChunkCoords(transform.Position); // New: Use WorldSimulation helper

                    // If entity is outside the loaded radius, dehydrate it
                    if (!IsChunkInLoadRadius(entityChunk))
                    {
                        if (_biologicalSystem.TryGetCoreStats(activeID, out CoreStats stats) &amp;&amp; _entityManager.TryGetEntityMeta(activeID, out EntityMeta meta))
                        {
                            // Create a new VirtualAgent from the active entity's current state
                            _virtualAgents.Add(new VirtualAgent(activeID, meta.Type, meta.DefinitionID, transform.Position, transform.RotationDegrees, stats, _aiSystem.GetSimplifiedAIState(activeID), _aiSystem.GetTargetID(activeID)));
                            activeEntitiesToDehydrate.Add(activeID);
                            GD.Print($&quot;EcologyManager: Dehydrating {activeID} (Type: {meta.Type}).&quot;);
                        }
                    }
                }
            }
            // Destroy active entities that were dehydrated (must be done on main thread)
            foreach (EntityID id in activeEntitiesToDehydrate)
            {
                _entityManager.DestroyEntity(id); // This also triggers OnEntityDespawned event for Body
            }

            // --- Hydration: Convert virtual agents in loaded chunks to active entities ---
            List&lt;VirtualAgent&gt; remainingVirtualAgents = new List&lt;VirtualAgent&gt;();

            foreach (VirtualAgent agent in _virtualAgents)
            {
                Vector2I agentChunk = GameManager.Instance.World.GetChunkCoords(agent.Position); // New: Use WorldSimulation helper

                if (IsChunkInLoadRadius(agentChunk))
                {
                    // Hydrate this agent (spawn active entity)
                    // TDD 05.4.2: Spawning - Instantiate actual Godot Nodes.
                    // When CreateEntity is called, it triggers OnEntitySpawned, which
                    // EntityViewManager.gd listens to.
                    _entityManager.CreateEntity(agent.Type, agent.DefinitionID, agent.Position, agent.RotationDegrees);
                    // Update the newly created active entity's stats from the virtual agent (TDD 05.4.2)
                    ref CoreStats hydratedStats = ref _biologicalSystem.GetCoreStatsRef(agent.ID);
                    hydratedStats = agent.CurrentStats; // Copy all stats from virtual agent
                    // Set AI state as well
                    _aiSystem.SetSimplifiedAIState(agent.ID, agent.SimplifiedAIState);
                    _aiSystem.SetTargetID(agent.ID, agent.TargetID);

                    GD.Print($&quot;EcologyManager: Hydrating {agent.ID} (Type: {agent.Type}).&quot;);
                }
                else
                {
                    remainingVirtualAgents.Add(agent); // Keep it virtual
                }
            }
            // Replace the ConcurrentBag with only the remaining virtual agents
            _virtualAgents = new ConcurrentBag&lt;VirtualAgent&gt;(remainingVirtualAgents);
        }

        /// &lt;summary&gt;
        /// Checks if a given chunk is within the player's loaded radius.
        /// &lt;/summary&gt;
        private bool IsChunkInLoadRadius(Vector2I chunkCoords)
        {
            return Mathf.Abs(chunkCoords.X - _playerLoadedChunk.X) &lt;= LOAD_RADIUS_CHUNKS &amp;&amp;
                   Mathf.Abs(chunkCoords.Y - _playerLoadedChunk.Y) &lt;= LOAD_RADIUS_CHUNKS;
        }

        // --- Helper: Get a list of all current virtual agents ---
        public IReadOnlyList&lt;VirtualAgent&gt; GetAllVirtualAgents()
        {
            return _virtualAgents.ToList().AsReadOnly();
        }
    }
}
</code></pre>
<h4 id="21-update-aisystemcs-for-simplified-ai-state">2.1. Update <code>AISystem.cs</code> for Simplified AI State</h4>
<p><code>EcologyManager</code> needs to get and set a simplified AI state for virtual agents.</p>
<ol>
<li>Open <code>res://_Brain/Systems/AI/AISystem.cs</code> and add <code>_simplifiedAIStates</code> dictionary and <code>GetSimplifiedAIState</code> / <code>SetSimplifiedAIState</code> / <code>GetTargetID</code> / <code>SetTargetID</code> methods.</li>
</ol>
<pre><code class="language-csharp">// _Brain/Systems/AI/AISystem.cs
using Godot;
using System;
using System.Collections.Generic;
using Sigilborne.Core;
using Sigilborne.Entities;
using Sigilborne.Entities.Components;
using Sigilborne.Systems.Biology;
using Sigilborne.Systems.Combat;
using System.Linq;

namespace Sigilborne.Systems.AI
{
    /// &lt;summary&gt;
    /// Manages AI decision-making using a Utility AI (scoring) system.
    /// NPCs evaluate actions based on needs and context and execute the highest-scoring one.
    /// (TDD 05.3)
    /// &lt;/summary&gt;
    public class AISystem
    {
        // ... (existing fields) ...
        // Simplified AI state for when an entity is virtual
        private Dictionary&lt;EntityID, string&gt; _simplifiedAIStates = new Dictionary&lt;EntityID, string&gt;();
        private Dictionary&lt;EntityID, EntityID&gt; _aiTargets = new Dictionary&lt;EntityID, EntityID&gt;();

        // ... (constructor) ...

        private void OnEntitySpawned(EntityID id, EntityType type, string definitionID, Vector2 initialPosition, float initialRotation)
        {
            if (type == EntityType.NPC || type == EntityType.Animal)
            {
                _aiComponents.Add(id, new AIComponent());
                _aiDecisionTimers.Add(id, (float)GameManager.Instance.Time.CurrentGameTime);
                _simplifiedAIStates.Add(id, &quot;Wandering&quot;); // Default simplified state
                _aiTargets.Add(id, EntityID.Invalid); // Default target
                GD.Print($&quot;AISystem: Added AIComponent for {type} entity {id}.&quot;);
            }
        }

        private void OnEntityDespawned(EntityManager.EntityDespawnedEvent e)
        {
            _aiComponents.Remove(e.ID);
            _aiDecisionTimers.Remove(e.ID);
            _simplifiedAIStates.Remove(e.ID);
            _aiTargets.Remove(e.ID);
            GD.Print($&quot;AISystem: Removed AIComponent for {e.ID}.&quot;);
        }

        // ... (OnPlayerAlerted, RegisterAction, RegisterDefaultActions methods) ...

        public void Tick(double delta) { /* ... */ }
        private void MakeDecision(EntityID npcID) { /* ... */ }

        /// &lt;summary&gt;
        /// Gets the simplified AI state for a given entity.
        /// &lt;/summary&gt;
        public string GetSimplifiedAIState(EntityID id)
        {
            return _simplifiedAIStates.TryGetValue(id, out string state) ? state : &quot;None&quot;;
        }

        /// &lt;summary&gt;
        /// Sets the simplified AI state for a given entity. Used during hydration.
        /// &lt;/summary&gt;
        public void SetSimplifiedAIState(EntityID id, string state)
        {
            if (_simplifiedAIStates.ContainsKey(id)) _simplifiedAIStates[id] = state;
        }

        /// &lt;summary&gt;
        /// Gets the target ID for a given entity.
        /// &lt;/summary&gt;
        public EntityID GetTargetID(EntityID id)
        {
            return _aiTargets.TryGetValue(id, out EntityID target) ? target : EntityID.Invalid;
        }

        /// &lt;summary&gt;
        /// Sets the target ID for a given entity. Used during hydration.
        /// &lt;/summary&gt;
        public void SetTargetID(EntityID id, EntityID target)
        {
            if (_aiTargets.ContainsKey(id)) _aiTargets[id] = target;
        }
    }
}
</code></pre>
<h4 id="22-update-gamemanager-to-pass-aisystem-to-ecologymanager">2.2. Update <code>GameManager</code> to Pass <code>AISystem</code> to <code>EcologyManager</code></h4>
<p>Open <code>res://_Brain/Core/GameManager.cs</code> and modify the <code>EcologyManager</code> initialization in <code>InitializeSystems()</code>:</p>
<pre><code class="language-csharp">// _Brain/Core/GameManager.cs (inside InitializeSystems)
// ...
        // Initialize EcologyManager AFTER all its dependencies, including AI
        Ecology = new EcologyManager(Entities, Events, BiologicalSystem, Transforms, AI, Movement, Weather, Jobs, SpatialGrid); // Pass AI
        GD.Print(&quot;  - EcologyManager initialized.&quot;);
// ...
</code></pre>
<h3 id="3-refining-worldsimulationcs-for-chunk-coordinates">3. Refining <code>WorldSimulation.cs</code> for Chunk Coordinates</h3>
<p><code>EcologyManager</code> needs to convert world positions to chunk coordinates. This logic should be in <code>WorldSimulation</code>.</p>
<p>Open <code>res://_Brain/Core/WorldSimulation.cs</code> and add <code>GetChunkCoords</code> method:</p>
<pre><code class="language-csharp">// _Brain/Core/WorldSimulation.cs
using Godot;
using System;
using Sigilborne.Systems.Ecology;

namespace Sigilborne.Core
{
    public class WorldSimulation
    {
        public EcologyManager Ecology { get; private set; }
        public float ChunkSize { get; private set; } = 128f;

        public WorldSimulation(EcologyManager ecologyManager) { /* ... */ }
        public void Tick(double delta) { /* ... */ }

        /// &lt;summary&gt;
        /// Converts world coordinates to grid cell (chunk) coordinates.
        /// &lt;/summary&gt;
        public Vector2I GetChunkCoords(Vector2 worldPosition)
        {
            return new Vector2I(
                (int)MathF.Floor(worldPosition.X / ChunkSize),
                (int)MathF.Floor(worldPosition.Y / ChunkSize)
            );
        }
    }
}
</code></pre>
<h3 id="4-testing-hydrationdehydration">4. Testing Hydration/Dehydration</h3>
<ol>
<li>Save all C# and GDScript files.</li>
<li>Run <code>Main.tscn</code>.</li>
<li>Load <code>Gameplay.tscn</code>.</li>
<li>Observe the console output.<ul>
<li><strong>Initial Spawns</strong>: The player, test NPC, and boss are spawned as active entities.</li>
<li><strong>Dehydration</strong>: Move the player far away (e.g., use WASD to move the player sprite to the edge of the screen, or use the debug console <code>/spawn Player player_default 1000 1000</code>).<ul>
<li>You should see <code>EcologyManager: Dehydrating EntityID(...) (Type: NPC/Animal).</code> messages. The NPC and boss active entities should visually disappear from the screen, and their <code>EntityView</code>s will be <code>queue_free()</code>d.</li>
</ul>
</li>
<li><strong>Hydration</strong>: Move the player back towards the original spawn location (e.g., <code>/spawn Player player_default 200 200</code>).<ul>
<li>You should see <code>EcologyManager: Hydrating EntityID(...) (Type: NPC/Animal).</code> messages. The NPC and boss entities should visually reappear.</li>
</ul>
</li>
<li><strong>Virtual Agent Tick</strong>: While entities are dehydrated, <code>EcologyManager: Processing Virtual Agent Tick.</code> messages will continue every 10 seconds, showing their simplified simulation.</li>
</ul>
</li>
</ol>
<p>This confirms our <code>EcologyManager</code> is effectively handling the hydration and dehydration process, transitioning entities between active and virtual states based on player proximity.</p>
<h3 id="summary">Summary</h3>
<p>You have successfully refined the <strong>Spawning &amp; Despawning</strong> mechanics, implementing a robust hydration (spawning) and dehydration (despawning) process for entities in Sigilborne. By enhancing <code>EcologyManager</code> to seamlessly convert entities between "Virtual Agent" (data-only in C# Brain) and "Active Entity" (fully simulated with Godot Nodes in GDScript Body) states, you've ensured efficient resource management and a persistent world illusion. This crucial system strictly adheres to TDD 05.4.2 and TDD 05.4.3's specifications, allowing entities to appear and disappear gracefully as the player navigates the world.</p>
<h3 id="next-steps">Next Steps</h3>
<p>This concludes <strong>Module 7: The Living World - Ecology &amp; AI</strong>. We will now move on to <strong>Module 8: Society, Politics &amp; Economy</strong>, starting with <strong>Faction System - The Relationship Graph (C#)</strong>, where we will design the core data structures for managing faction relationships and their dynamic interactions.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>